<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>TikklBank í…ŒìŠ¤íŠ¸ í”Œë¡œìš°</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f7fb;
      margin: 0;
      padding: 20px;
    }
    h1 {
      margin-bottom: 8px;
    }
    h2 {
      margin-top: 24px;
      margin-bottom: 8px;
    }
    .section {
      background: #ffffff;
      border-radius: 14px;
      padding: 16px 18px;
      margin-bottom: 16px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.04);
    }
    .row {
      display: flex;
      gap: 8px;
      margin-bottom: 8px;
      flex-wrap: wrap;
      align-items: center;
    }
    label {
      font-size: 13px;
      color: #555;
      margin-right: 4px;
    }
    input, select {
      padding: 6px 8px;
      border-radius: 6px;
      border: 1px solid #ccd4e0;
      font-size: 13px;
    }
    button {
      padding: 6px 10px;
      border-radius: 6px;
      border: none;
      font-size: 13px;
      cursor: pointer;
      background: #2f80ed;
      color: #fff;
      white-space: nowrap;
    }
    button.secondary {
      background: #4caf50;
    }
    button.warn {
      background: #ff9800;
    }
    button.outline {
      background: #ffffff;
      color: #2f80ed;
      border: 1px solid #2f80ed;
    }
    small {
      font-size: 12px;
      color: #777;
    }
    .badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: #eef2ff;
      color: #4f46e5;
      margin-left: 4px;
    }
    pre {
      background: #0b1020;
      color: #e4ecff;
      padding: 10px;
      border-radius: 8px;
      font-size: 12px;
      overflow-x: auto;
      max-height: 280px;
    }
    .two-col {
      display: grid;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
      gap: 12px;
    }
    ul.guide {
      margin: 4px 0 0 0;
      padding-left: 16px;
      font-size: 12px;
      color: #666;
    }
    ul.guide li {
      margin-bottom: 2px;
    }
  </style>
</head>
<body>
<h1>ğŸ§ª TikklBank ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸</h1>
<p style="font-size:13px; color:#555;">
  1) íšŒì›ê°€ì…/ë¡œê·¸ì¸ â†’ 2) ê³„ì¢Œ ì¤€ë¹„ â†’ 3) í‹°í´í†µì¥/ê¸ˆìœµìƒí’ˆ ì„¤ì • â†’ 4) ì¹´ë“œìƒí’ˆ ì„ íƒ & ì¹´ë“œ ë“±ë¡ â†’
  5) ì¹´ë“œ ê²°ì œ (ì›ì²œ ê³„ì¢Œ â†’ í‹°í´í†µì¥) â†’ 6) í•˜ë£¨ ê²½ê³¼(ì´ì) / ì›”ë§ ê²°ì œ â†’ 7) ëŒ€ì‹œë³´ë“œ í™•ì¸
  <span id="currentMemberBadge" class="badge" style="display:none;"></span>
</p>

<!-- 0. íšŒì›ê°€ì… / ë¡œê·¸ì¸ -->
<div class="section">
  <h2>0. íšŒì›ê°€ì… & ë¡œê·¸ì¸</h2>

  <div class="row">
    <strong style="font-size:13px;">íšŒì›ê°€ì…</strong>
    <label for="signupName">ì´ë¦„</label>
    <input type="text" id="signupName" placeholder="ì˜ˆ: í™ê¸¸ë™">
    <label for="signupEmail">ì´ë©”ì¼</label>
    <input type="email" id="signupEmail" placeholder="test@example.com">
    <label for="signupPassword">ë¹„ë°€ë²ˆí˜¸</label>
    <input type="password" id="signupPassword" placeholder="1234">
    <button onclick="signUp()">íšŒì›ê°€ì…</button>
  </div>
  <ul class="guide">
    <li>ì—”ë“œí¬ì¸íŠ¸ ì˜ˆì‹œ: <code>POST /api/members/signup</code> (name, email, password)</li>
    <li>ì‘ë‹µì—ì„œ memberIdë¥¼ ì¶”ì¶œí•´ì„œ ì•„ë˜ ê³µí†µ ì…ë ¥ì— ìë™ ì„¸íŒ…</li>
  </ul>

  <div class="row">
    <strong style="font-size:13px;">ë¡œê·¸ì¸</strong>
    <label for="loginEmail">ì´ë©”ì¼</label>
    <input type="email" id="loginEmail" placeholder="test@example.com">
    <label for="loginPassword">ë¹„ë°€ë²ˆí˜¸</label>
    <input type="password" id="loginPassword" placeholder="1234">
    <button class="secondary" onclick="login()">ë¡œê·¸ì¸</button>
    <small id="loginStatus"></small>
  </div>
  <ul class="guide">
    <li>ì—”ë“œí¬ì¸íŠ¸ ì˜ˆì‹œ: <code>POST /api/members/login</code> (email, password)</li>
    <li>ì‘ë‹µì—ì„œ memberIdë¥¼ ì¶”ì¶œí•´ì„œ ì•„ë˜ ê³µí†µ ì…ë ¥ì— ìë™ ì„¸íŒ…</li>
  </ul>
</div>

<!-- 1. ê³µí†µ ì…ë ¥ -->
<div class="section">
  <h2>1. ê³µí†µ ì…ë ¥ (íšŒì› / ê³„ì¢Œ / ì¹´ë“œ)</h2>
  <div class="row">
    <label for="memberId">íšŒì› ID</label>
    <input type="number" id="memberId" placeholder="ì˜ˆ: 1">
    <label for="accountId">ì›ì²œ ê³„ì¢Œ ID</label>
    <input type="number" id="accountId" placeholder="ì¹´ë“œì— ì—°ê²°í•  ì¼ë°˜ ê³„ì¢Œ ID">
    <label for="cardId">ì¹´ë“œ ID</label>
    <input type="number" id="cardId" placeholder="ê²°ì œì— ì‚¬ìš©í•  ì¹´ë“œ ID">
  </div>
  <ul class="guide">
    <li>íšŒì›ê°€ì…/ë¡œê·¸ì¸ì´ ì„±ê³µí•˜ë©´ ì—¬ê¸° <strong>memberId</strong>ì— ìë™ ì±„ì›Œì§.</li>
    <li>ê³„ì¢Œ(ID)ëŠ” ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘” ê³„ì¢Œ IDë¥¼ ë„£ê³ , ì…ê¸ˆ/ì¶œê¸ˆ ë²„íŠ¼ìœ¼ë¡œ ì”ì•¡ ì„¸íŒ….</li>
  </ul>
</div>

<!-- 2. ê³„ì¢Œ ì…ì¶œê¸ˆ í…ŒìŠ¤íŠ¸ -->
<div class="section">
  <h2>2. ê³„ì¢Œ ì…ì¶œê¸ˆ í…ŒìŠ¤íŠ¸</h2>
  <div class="row">
    <label for="amount">ê¸ˆì•¡</label>
    <input type="number" id="amount" placeholder="ì˜ˆ: 100000">
    <button onclick="deposit()">ì…ê¸ˆ</button>
    <button onclick="withdraw()">ì¶œê¸ˆ</button>
  </div>
  <ul class="guide">
    <li>ì…ê¸ˆ: <code>POST /api/accounts/{accountId}/deposit</code> body: <code>{ amount }</code></li>
    <li>ì¶œê¸ˆ: <code>POST /api/accounts/{accountId}/withdraw</code> body: <code>{ amount }</code></li>
    <li>í…ŒìŠ¤íŠ¸: ë¨¼ì € ì…ê¸ˆìœ¼ë¡œ ì›ì²œ ê³„ì¢Œì— ì¶©ë¶„í•œ ëˆì„ ì±„ì›Œë‘ê³ , ì´í›„ ì¹´ë“œ ê²°ì œ í”Œë¡œìš° ì§„í–‰.</li>
  </ul>
</div>

<!-- 3. ì¹´ë“œ ìƒí’ˆ ì¡°íšŒ & ì¹´ë“œ ë“±ë¡ -->
<div class="section">
  <h2>3. ì¹´ë“œ ìƒí’ˆ ì¡°íšŒ & ì¹´ë“œ ë“±ë¡</h2>
  <div class="row">
    <button onclick="loadCardProducts()">ì¹´ë“œ ìƒí’ˆ ëª©ë¡ ì¡°íšŒ</button>
    <label for="cardProductId">ì„ íƒ ì¹´ë“œìƒí’ˆ ID</label>
    <input type="number" id="cardProductId" placeholder="ìœ„ ëª©ë¡ì—ì„œ ì„ íƒ">
    <label for="cardNickname">ì¹´ë“œ ë‹‰ë„¤ì„</label>
    <input type="text" id="cardNickname" placeholder="ì˜ˆ: í¸ì˜ì  30% ì¹´ë“œ">
    <button class="secondary" onclick="registerCard()">ì¹´ë“œ ë“±ë¡</button>
  </div>
  <ul class="guide">
    <li>ìƒí’ˆ ì¡°íšŒ: <code>GET /api/card-products</code> â†’ ì‘ë‹µì—ì„œ <code>id</code> ë³´ê³  cardProductIdì— ì…ë ¥.</li>
    <li>ì¹´ë“œ ë°œê¸‰: <code>POST /api/members/{memberId}/cards</code> body:
      <code>{ cardProductId, sourceAccountId, nickname }</code></li>
    <li>ì„±ê³µ ì‹œ ì‘ë‹µ ì•ˆì˜ cardId(or id)ë¥¼ ìë™ìœ¼ë¡œ ì¹´ë“œ ID ì…ë ¥ì¹¸ì— ì±„ì›€.</li>
  </ul>
</div>

<!-- 4. ì¹´ë“œ ê²°ì œ (ì›ì²œ ê³„ì¢Œ â†’ í‹°í´í†µì¥) -->
<div class="section">
  <h2>4. ì¹´ë“œ ê²°ì œ (ì›ì²œ ê³„ì¢Œ â†’ í‹°í´í†µì¥)</h2>
  <div class="row">
    <label for="payAmount">ê²°ì œ ê¸ˆì•¡</label>
    <input type="number" id="payAmount" placeholder="ì˜ˆ: 30000">
    <label for="category">ì¹´í…Œê³ ë¦¬</label>
    <input type="text" id="category" placeholder="í¸ì˜ì , ì¹´í˜, í†µì‹ ë¹„ ë“±">
    <button onclick="payWithCard()">ì¹´ë“œ ê²°ì œ</button>
    <button class="outline" onclick="quickConvenience()">í¸ì˜ì  3ë§Œì› í…ŒìŠ¤íŠ¸</button>
  </div>
  <ul class="guide">
    <li>ì—”ë“œí¬ì¸íŠ¸: <code>POST /api/cards/{cardId}/payments</code></li>
    <li>body ì˜ˆ:
      <code>{ "amount": 30000, "category": "í¸ì˜ì ", "description": "í…ŒìŠ¤íŠ¸ ê²°ì œ" }</code>
    </li>
    <li>í¸ì˜ì  3ë§Œì› í…ŒìŠ¤íŠ¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ amount=30000, category="í¸ì˜ì " ìœ¼ë¡œ ìë™ í˜¸ì¶œ.</li>
  </ul>
</div>

<!-- 5. ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œë®¬ë ˆì´ì…˜ -->
<div class="section">
  <h2>5. ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œë®¬ë ˆì´ì…˜ (í•˜ë£¨ ê²½ê³¼ / ì›”ë§ ê²°ì œ)</h2>
  <div class="row">
    <button class="secondary" onclick="simulateDay()">í•˜ë£¨ ê²½ê³¼ (ì´ì ì ë¦½ ì‹¤í–‰)</button>
    <button class="warn" onclick="simulateMonthEnd()">ì›”ë§ ê²°ì œ (ì§€ë‚œë‹¬ ì²­êµ¬ + ìë™ê²°ì œ)</button>
  </div>
  <ul class="guide">
    <li>í•˜ë£¨ ê²½ê³¼: <code>POST /api/dev/simulate/day</code> â†’ ë§¤ì¼ 1íšŒ ëŒë˜ ì´ì ì ë¦½ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ê°•ì œë¡œ ì‹¤í–‰.</li>
    <li>ì›”ë§ ê²°ì œ: <code>POST /api/dev/simulate/month-end</code> â†’ ì§€ë‚œë‹¬ ì¹´ë“œ ì²­êµ¬ë¥¼ í‹°í´ë±…í¬ì—ì„œ ìë™ ê²°ì œ.</li>
  </ul>
</div>

<!-- 6. í‹°í´í†µì¥ & ëŒ€ì‹œë³´ë“œ ì¡°íšŒ -->
<div class="section">
  <h2>6. í‹°í´í†µì¥ & ëŒ€ì‹œë³´ë“œ ì¡°íšŒ</h2>
  <div class="row">
    <button onclick="loadSavings()">í‹°í´í†µì¥ ì¡°íšŒ</button>
    <button onclick="loadDashboard()">ëŒ€ì‹œë³´ë“œ ì¡°íšŒ</button>
  </div>
  <ul class="guide">
    <li>í‹°í´í†µì¥: <code>GET /api/members/{memberId}/savings</code></li>
    <li>ëŒ€ì‹œë³´ë“œ: <code>GET /api/members/{memberId}/dashboard</code></li>
    <li>ëŒ€ì‹œë³´ë“œ ì‘ë‹µì—ëŠ” ì”ì•¡, ëˆ„ì  ì´ì, ì´ë²ˆë‹¬ ì´ì, ë‹¤ìŒë‹¬ ì²­êµ¬ ì˜ˆì • ê¸ˆì•¡, í˜œíƒ êµ¬ê°„ë¥  ë“±ì´ ë“¤ì–´ê°.</li>
  </ul>
</div>

<!-- 7. ì „ì²´ í”Œë¡œìš° ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ -->
<div class="section">
  <h2>7. ì „ì²´ í”Œë¡œìš° ì‹œë‚˜ë¦¬ì˜¤ (ì›í´ë¦­ í…ŒìŠ¤íŠ¸)</h2>
  <div class="two-col">
    <div>
      <div class="row">
        <button class="secondary" onclick="runFullFlow()">â‘ -â‘¦ í•œ ë²ˆì— ì‹¤í–‰ (ê¸°ë³¸ ì‹œë‚˜ë¦¬ì˜¤)</button>
      </div>
      <ul class="guide">
        <li>ì „ì œ:
          <ul class="guide">
            <li>memberId, accountId, cardProductIdëŠ” ì´ë¯¸ ì…ë ¥ ë˜ëŠ” ìƒì„±.</li>
            <li>ê³„ì¢Œì— ì–´ëŠ ì •ë„ ì”ì•¡ì´ ìˆì–´ì•¼ í•¨.</li>
          </ul>
        </li>
        <li>ìˆœì„œ:
          <ul class="guide">
            <li>â‘  ì›ì²œ ê³„ì¢Œ ì…ê¸ˆ (ì˜ˆ: 100,000ì›)</li>
            <li>â‘¡ ì¹´ë“œìƒí’ˆìœ¼ë¡œ ì¹´ë“œ ë°œê¸‰</li>
            <li>â‘¢ í¸ì˜ì  3ë§Œì› ê²°ì œ (í‹°í´í†µì¥ìœ¼ë¡œ ì´ë™)</li>
            <li>â‘£ í•˜ë£¨ ê²½ê³¼ ì‹œë®¬ë ˆì´ì…˜ (ì´ì ì ë¦½)</li>
            <li>â‘¤ ì›”ë§ ê²°ì œ ì‹œë®¬ë ˆì´ì…˜</li>
            <li>â‘¥ ëŒ€ì‹œë³´ë“œ ì¡°íšŒ</li>
          </ul>
        </li>
      </ul>
    </div>
    <div>
      <small>â€» ì‹¤ì œë¡œëŠ” ê° ë‹¨ê³„ë³„ë¡œ ë¡œê·¸ ì„¹ì…˜ì— ìš”ì²­/ì‘ë‹µì´ ìˆœì„œëŒ€ë¡œ ìŒ“ì´ë‹ˆ,
        ì–´ë–¤ ì…ë ¥ìœ¼ë¡œ ì–´ë–¤ ê²°ê³¼ê°€ ë‚˜ì™”ëŠ”ì§€ í•œ ë²ˆì— í™•ì¸í•  ìˆ˜ ìˆìŒ.</small>
    </div>
  </div>
</div>

<!-- ì‘ë‹µ ë¡œê·¸ -->
<div class="section">
  <h2>ì‘ë‹µ ë¡œê·¸ (ì…ë ¥ & ê²°ê³¼)</h2>
  <pre id="log"></pre>
</div>

<script>
  const state = {
    memberId: null,
    lastAction: null,
  };

  function setMemberId(id) {
    if (!id) return;
    state.memberId = id;
    document.getElementById('memberId').value = id;
    const badge = document.getElementById('currentMemberBadge');
    badge.textContent = `í˜„ì¬ ë¡œê·¸ì¸ íšŒì›: #${id}`;
    badge.style.display = 'inline-block';
  }

  function log(obj) {
    const pre = document.getElementById('log');
    pre.textContent = JSON.stringify(obj, null, 2);
  }

  function extractId(result) {
    if (!result) return null;
    const d = result.data ?? result;
    if (!d) return null;
    // ì‘ë‹µ êµ¬ì¡°ì— ë”°ë¼ id / memberId / memberNo ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©
    return d.id ?? d.memberId ?? d.memberNo ?? null;
  }

  async function api(method, url, body, label) {
    const options = { method, headers: { 'Content-Type': 'application/json' } };
    if (body && (method === 'POST' || method === 'PUT' || method === 'PATCH')) {
      options.body = JSON.stringify(body);
    }

    let res, data;
    try {
      res = await fetch(url, options);
      const text = await res.text();
      try {
        data = text ? JSON.parse(text) : {};
      } catch (e) {
        data = { raw: text };
      }
    } catch (e) {
      log({ action: label, url, error: e.message });
      throw e;
    }

    log({
      action: label,
      method,
      url,
      requestBody: body ?? null,
      status: res.status,
      response: data,
    });

    return data;
  }

  // 0. íšŒì›ê°€ì… / ë¡œê·¸ì¸
  async function signUp() {
    const name = document.getElementById('signupName').value;
    const email = document.getElementById('signupEmail').value;
    const password = document.getElementById('signupPassword').value;

    // ğŸ”§ backendì— ë§ì¶° URL/í•„ë“œëª…ì€ í•„ìš”í•˜ë©´ ìˆ˜ì •
    const result = await api('POST', '/api/members/signup', {
      name, email, password
    }, 'íšŒì›ê°€ì…');

    const id = extractId(result);
    if (id) {
      setMemberId(id);
      document.getElementById('loginStatus').textContent = `íšŒì›ê°€ì… ì„±ê³µ (id=${id})`;
    }
  }

  async function login() {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;

    const result = await api('POST', '/api/auth/login', {
      email, password
    }, 'ë¡œê·¸ì¸');

    const id = extractId(result);
    if (id) {
      setMemberId(id);
      document.getElementById('loginStatus').textContent = `ë¡œê·¸ì¸ ì„±ê³µ (id=${id})`;
    } else {
      document.getElementById('loginStatus').textContent = `ë¡œê·¸ì¸ ì‘ë‹µì—ì„œ memberIdë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ`;
    }
  }

  // 2. ê³„ì¢Œ ì…ì¶œê¸ˆ
  async function deposit() {
    const accountId = document.getElementById('accountId').value;
    const amount = Number(document.getElementById('amount').value);
    await api('POST', `/api/accounts/${accountId}/deposit`, { amount }, 'ê³„ì¢Œ ì…ê¸ˆ');
  }

  async function withdraw() {
    const accountId = document.getElementById('accountId').value;
    const amount = Number(document.getElementById('amount').value);
    await api('POST', `/api/accounts/${accountId}/withdraw`, { amount }, 'ê³„ì¢Œ ì¶œê¸ˆ');
  }

  // 3. ì¹´ë“œ ìƒí’ˆ ì¡°íšŒ & ì¹´ë“œ ë“±ë¡
  async function loadCardProducts() {
    await api('GET', '/api/card-products', null, 'ì¹´ë“œ ìƒí’ˆ ëª©ë¡ ì¡°íšŒ');
  }

  async function registerCard() {
    const memberId = document.getElementById('memberId').value;
    const cardProductId = document.getElementById('cardProductId').value;
    const sourceAccountId = document.getElementById('accountId').value;
    const nickname = document.getElementById('cardNickname').value || 'ë‚´ ì¹´ë“œ';

    const result = await api('POST', `/api/members/${memberId}/cards`, {
      cardProductId,
      sourceAccountId,
      nickname
    }, 'ì¹´ë“œ ë°œê¸‰');

    // ApiResponse êµ¬ì¡°ì— ë§ê²Œ ì¹´ë“œ ID ë½‘ì•„ì„œ inputì— ì±„ì›Œì£¼ê¸°
    let cardId = null;
    if (result) {
      const d = result.data ?? result;
      if (d) {
        cardId = d.cardId ?? d.id ?? d.cardNo ?? null;
      }
    }
    if (cardId) {
      document.getElementById('cardId').value = cardId;
    }
  }

  // 4. ì¹´ë“œ ê²°ì œ
  async function payWithCard() {
    const cardId = document.getElementById('cardId').value;
    const amount = Number(document.getElementById('payAmount').value);
    const category = document.getElementById('category').value || 'ê¸°íƒ€';

    await api('POST', `/api/cards/${cardId}/payments`, {
      amount,
      category,
      description: 'í…ŒìŠ¤íŠ¸ ê²°ì œ'
    }, 'ì¹´ë“œ ê²°ì œ');
  }

  // í¸ì˜ì  3ë§Œì› ìƒ˜í”Œ
  async function quickConvenience() {
    document.getElementById('payAmount').value = 30000;
    document.getElementById('category').value = 'í¸ì˜ì ';
    await payWithCard();
  }

  // 5. ìŠ¤ì¼€ì¤„ëŸ¬ ì‹œë®¬ë ˆì´ì…˜
  async function simulateDay() {
    await api('POST', '/api/dev/simulate/day', null, 'í•˜ë£¨ ê²½ê³¼ (ì´ì ì ë¦½ ì‹œë®¬ë ˆì´í„°)');
  }

  async function simulateMonthEnd() {
    await api('POST', '/api/dev/simulate/month-end', null, 'ì›”ë§ ê²°ì œ ì‹œë®¬ë ˆì´í„°');
  }

  // 6. í‹°í´í†µì¥ & ëŒ€ì‹œë³´ë“œ
  async function loadSavings() {
    const memberId = document.getElementById('memberId').value;
    await api('GET', `/api/members/${memberId}/savings`, null, 'í‹°í´í†µì¥ ì¡°íšŒ');
  }

  async function loadDashboard() {
    const memberId = document.getElementById('memberId').value;
    await api('GET', `/api/members/${memberId}/dashboard`, null, 'ëŒ€ì‹œë³´ë“œ ì¡°íšŒ');
  }

  // 7. ì „ì²´ í”Œë¡œìš° ìë™ ì‹¤í–‰
  async function runFullFlow() {
    const memberId = document.getElementById('memberId').value;
    const accountId = document.getElementById('accountId').value;
    const cardProductId = document.getElementById('cardProductId').value;

    if (!memberId || !accountId || !cardProductId) {
      alert('memberId, accountId, cardProductId ë¥¼ ë¨¼ì € ì…ë ¥í•˜ê±°ë‚˜ ìƒì„±í•´ ì£¼ì„¸ìš”.');
      return;
    }

    try {
      // 1) ê³„ì¢Œì— 100,000ì› ì…ê¸ˆ
      await api('POST', `/api/accounts/${accountId}/deposit`,
          { amount: 100000 }, 'í”Œë¡œìš°â‘  ê³„ì¢Œ ì…ê¸ˆ 100,000');

      // 2) ì¹´ë“œ ë°œê¸‰
      const cardRes = await api('POST', `/api/members/${memberId}/cards`, {
        cardProductId,
        sourceAccountId: accountId,
        nickname: 'í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ì¹´ë“œ'
      }, 'í”Œë¡œìš°â‘¡ ì¹´ë“œ ë°œê¸‰');

      let cardId = null;
      if (cardRes) {
        const d = cardRes.data ?? cardRes;
        if (d) {
          cardId = d.cardId ?? d.id ?? d.cardNo ?? null;
        }
      }
      if (cardId) {
        document.getElementById('cardId').value = cardId;
      }

      // 3) í¸ì˜ì  3ë§Œì› ê²°ì œ
      await api('POST', `/api/cards/${cardId}/payments`, {
        amount: 30000,
        category: 'í¸ì˜ì ',
        description: 'í”Œë¡œìš° í¸ì˜ì  3ë§Œì› ê²°ì œ'
      }, 'í”Œë¡œìš°â‘¢ í¸ì˜ì  3ë§Œì› ê²°ì œ');

      // 4) í•˜ë£¨ ê²½ê³¼ (ì´ì ì ë¦½)
      await api('POST', '/api/dev/simulate/day', null, 'í”Œë¡œìš°â‘£ í•˜ë£¨ ê²½ê³¼ (ì´ì ì ë¦½)');

      // 5) ì›”ë§ ê²°ì œ
      await api('POST', '/api/dev/simulate/month-end', null, 'í”Œë¡œìš°â‘¤ ì›”ë§ ê²°ì œ');

      // 6) ëŒ€ì‹œë³´ë“œ ì¡°íšŒ
      await api('GET', `/api/members/${memberId}/dashboard`, null, 'í”Œë¡œìš°â‘¥ ëŒ€ì‹œë³´ë“œ ì¡°íšŒ');
    } catch (e) {
      console.error(e);
      alert('í”Œë¡œìš° ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë¡œê·¸ ì˜ì—­ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.');
    }
  }
</script>
</body>
</html>